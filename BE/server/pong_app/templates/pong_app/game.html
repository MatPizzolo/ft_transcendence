<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pong Game Test</title>
</head>
<body>
    <h1>Pong Game</h1>
    <label for="username">Enter Your Username:</label>
    <input type="text" id="username" required>
    <button onclick="connectToGame()">Connect to Game</button>
    <button onclick="pressButton()">Press Button</button>

    <div id="output"></div>

    <script>
        let socket;

        function connectToGame() {
            const usernameInput = document.getElementById('username');
            const username = usernameInput.value;

            // Close existing WebSocket connection, if any
            if (socket && socket.readyState === WebSocket.OPEN) {
                socket.close();
            }

            // Establish a new WebSocket connection
            const roomName = 'some_room';  // Adjust the room name based on your setup
            socket = new WebSocket(`ws://localhost:8000/ws/pong/${roomName}/?username=${username}`);

            // Connection opened
            socket.addEventListener('open', (event) => {
                console.log('WebSocket Connection Opened:', event);
            });

            // Listen for messages from the server
            socket.addEventListener('message', (event) => {
                console.log('WebSocket Message Received:', event.data);
                displayMessage(event.data);
            });

            // Listen for any errors that occur.
            socket.addEventListener('error', (event) => {
                console.error('WebSocket Error:', event);
            });

            // Connection closed
            socket.addEventListener('close', (event) => {
                console.log('WebSocket Connection Closed:', event);
            });
        }

        function pressButton() {
            // Send a button press message to the server
            socket.send(JSON.stringify({
                type: 'button.press'
            }));
        }

        function displayMessage(message) {
            const outputDiv = document.getElementById('output');
            outputDiv.innerHTML += `<p>${message}</p>`;
        }
    </script>
</body>
</html>
